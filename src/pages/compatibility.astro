---
import DefaultLayout from "@layouts/Layout.astro";
import compatibility from "@data/compatibility.json";

const title = "Compatibilidad entre signos | AstroAura";
const description =
  "Descubre quÃ© signos son mÃ¡s compatibles contigo segÃºn la astrologÃ­a.";
---

<DefaultLayout {title} {description}>
  <main class="max-w-xl mx-auto p-4 sm:p-6 text-white">
    <h1 class="text-2xl sm:text-3xl font-bold text-center mb-6">
      ğŸ’– Compatibilidad de signos
    </h1>

    <form id="form" class="flex flex-col gap-4 mb-6">
      <label class="text-lg">
        Tu signo:
        <select
          name="mysign"
          class="w-full p-3 bg-black border border-purple-500 rounded text-base mt-1"
        >
          {
            Object.keys(compatibility).map((sign) => (
              <option value={sign}>{sign}</option>
            ))
          }
        </select>
      </label>
      <label class="text-lg">
        Signo de tu pareja/crush:
        <select
          name="crushsign"
          class="w-full p-3 bg-black border border-pink-500 rounded text-base mt-1"
        >
          {
            Object.keys(compatibility).map((sign) => (
              <option value={sign}>{sign}</option>
            ))
          }
        </select>
      </label>
      <button
        type="submit"
        class="bg-gradient-to-r from-purple-600 to-pink-600 text-white py-3 px-4 rounded text-lg font-medium hover:scale-105 transition mt-2"
      >
        Ver compatibilidad
      </button>
    </form>

    <div
      id="result"
      class="hidden border border-purple-700 rounded p-4 bg-purple-900/30"
    >
      <h2 class="text-xl font-semibold mb-2">ğŸ”— Resultado:</h2>
      <p id="compatibilityText" class="text-base sm:text-lg">
        AquÃ­ aparecerÃ¡ el resultado...
      </p>
    </div>
  </main>
  <div id="data-container" data-compatibility={`${JSON.stringify(compatibility)}`}></div>
  <script type="module" is:inline>
    const form = document.querySelector("#form");
    const result = document.querySelector("#result");
    const text = document.querySelector("#compatibilityText");

    // Retrieve compatibility data from the data attribute
    const data = JSON.parse(document.querySelector("#data-container").dataset.compatibility);

    form.addEventListener("submit", (e) => {
      e.preventDefault();
      const sign1 = form.mysign.value;
      const sign2 = form.crushsign.value;

      if (data[sign1]?.compatibles.includes(sign2)) {
        text.innerText = `Â¡${sign1} y ${sign2} son muy compatibles! ğŸ’ ${data[sign1].mensaje}`;
      } else {
        text.innerText = `Hmm... ${sign1} y ${sign2} pueden tener desafÃ­os. ğŸŒ€ ${data[sign1].mensaje}`;
      }

      result.classList.remove("hidden");
    });
</script>
</DefaultLayout>
